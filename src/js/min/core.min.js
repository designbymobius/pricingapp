(function(){var a,b,c,d,e,f,g;d=function(a,b){var c,d,e,f;f=[];for(d in b.prototype)try{e=b.prototype[d],f.push(null==a[d]&&"function"!=typeof e?a[d]=e:void 0)}catch(g){c=g}return f},a={},null==a.options&&(a.options={}),c={checks:{xhr:{url:function(){return"/offline-test-request/"+Math.floor(1e9*Math.random())}},image:{url:function(){return"http://dqakt69vkj09v.cloudfront.net/are-we-online.gif?_="+Math.floor(1e9*Math.random())}},active:"image"},checkOnLoad:!1,interceptRequests:!0,reconnect:!0},e=function(a,b){var c,d,e,f,g,h;for(c=a,f=b.split("."),d=g=0,h=f.length;h>g&&(e=f[d],c=c[e],"object"==typeof c);d=++g);return d===f.length-1?c:void 0},a.getOption=function(b){var d,f;return d=null!=(f=e(a.options,b))?f:e(c,b),"function"==typeof d?d():d},"function"==typeof window.addEventListener&&window.addEventListener("online",function(){return setTimeout(a.confirmUp,100)},!1),"function"==typeof window.addEventListener&&window.addEventListener("offline",function(){return a.confirmDown()},!1),a.state="up",a.markUp=function(){return a.trigger("confirmed-up"),"up"!==a.state?(a.state="up",a.trigger("up")):void 0},a.markDown=function(){return a.trigger("confirmed-down"),"down"!==a.state?(a.state="down",a.trigger("down")):void 0},f={},a.on=function(b,c,d){var e,g,h,i,j;if(g=b.split(" "),g.length>1){for(j=[],h=0,i=g.length;i>h;h++)e=g[h],j.push(a.on(e,c,d));return j}return null==f[b]&&(f[b]=[]),f[b].push([d,c])},a.off=function(a,b){var c,d,e,g,h;if(null!=f[a]){if(b){for(d=0,h=[];d<f[a].length;)g=f[a][d],c=g[0],e=g[1],h.push(e===b?f[a].splice(d,1):d++);return h}return f[a]=[]}},a.trigger=function(a){var b,c,d,e,g,h,i;if(null!=f[a]){for(g=f[a],i=[],d=0,e=g.length;e>d;d++)h=g[d],b=h[0],c=h[1],i.push(c.call(b));return i}},b=function(a,b,c){var d,e;return d=function(){return a.status&&a.status<12e3?b():c()},null===a.onprogress?(a.addEventListener("error",c,!1),a.addEventListener("timeout",c,!1),a.addEventListener("load",d,!1)):(e=a.onreadystatechange,a.onreadystatechange=function(){return 4===a.readyState?d():0===a.readyState&&c(),"function"==typeof e?e.apply(null,arguments):void 0})},a.checks={},a.checks.xhr=function(){var c,d;d=new XMLHttpRequest,d.offline=!1,d.open("HEAD",a.getOption("checks.xhr.url"),!0),b(d,a.markUp,a.markDown);try{d.send()}catch(e){c=e,a.markDown()}return d},a.checks.image=function(){var b;return b=document.createElement("img"),b.onerror=a.markDown,b.onload=a.markUp,void(b.src=a.getOption("checks.image.url"))},a.check=function(){return a.trigger("checking"),a.checks[a.getOption("checks.active")]()},a.confirmUp=a.confirmDown=a.check,a.onXHR=function(a){var b,c,e;return b=function(b,c){var d;return d=b.open,b.open=function(e,f,g,h,i){return a({type:e,url:f,async:g,flags:c,user:h,password:i,xhr:b}),d.apply(b,arguments)}},e=window.XMLHttpRequest,window.XMLHttpRequest=function(a){var c,d,f;return c=new e(a),b(c,a),f=c.setRequestHeader,c.headers={},c.setRequestHeader=function(a,b){return c.headers[a]=b,f.call(c,a,b)},d=c.overrideMimeType,c.overrideMimeType=function(a){return c.mimeType=a,d.call(c,a)},c},d(window.XMLHttpRequest,e),null!=window.XDomainRequest?(c=window.XDomainRequest,window.XDomainRequest=function(){var a;return a=new c,b(a),a},d(window.XDomainRequest,c)):void 0},g=function(){return a.getOption("interceptRequests")&&a.onXHR(function(c){var d;return d=c.xhr,d.offline!==!1?b(d,a.confirmUp,a.confirmDown):void 0}),a.getOption("checkOnLoad")?a.check():void 0},setTimeout(g,0),window.Offline=a}).call(this),function(){var a,b,c,d,e,f,g,h,i;if(!window.Offline)throw new Error("Offline Reconnect brought in without offline.js");d=Offline.reconnect={},f=null,e=function(){var a;return null!=d.state&&"inactive"!==d.state&&Offline.trigger("reconnect:stopped"),d.state="inactive",d.remaining=d.delay=null!=(a=Offline.getOption("reconnect.initialDelay"))?a:3},b=function(){var a,b;return a=null!=(b=Offline.getOption("reconnect.delay"))?b:Math.min(Math.ceil(1.5*d.delay),3600),d.remaining=d.delay=a},g=function(){return"connecting"!==d.state?(d.remaining-=1,Offline.trigger("reconnect:tick"),0===d.remaining?h():void 0):void 0},h=function(){return"waiting"===d.state?(Offline.trigger("reconnect:connecting"),d.state="connecting",Offline.check()):void 0},a=function(){return Offline.getOption("reconnect")?(e(),d.state="waiting",Offline.trigger("reconnect:started"),f=setInterval(g,1e3)):void 0},i=function(){return null!=f&&clearInterval(f),e()},c=function(){return Offline.getOption("reconnect")?"connecting"===d.state?(Offline.trigger("reconnect:failure"),d.state="waiting",b()):void 0:void 0},d.tryNow=h,e(),Offline.on("down",a),Offline.on("confirmed-down",c),Offline.on("up",i)}.call(this),function(){var a,b,c,d,e,f;if(!window.Offline)throw new Error("Requests module brought in without offline.js");c=[],f=!1,d=function(a){return Offline.trigger("requests:capture"),"down"!==Offline.state&&(f=!0),c.push(a)},e=function(a){var b,c,d,e,f,g,h,i,j;i=a.xhr,f=a.url,e=a.type,g=a.user,d=a.password,b=a.body,i.abort(),i.open(e,f,!0,g,d),j=i.headers;for(c in j)h=j[c],i.setRequestHeader(c,h);return i.mimeType&&i.overrideMimeType(i.mimeType),i.send(b)},a=function(){return c=[]},b=function(){var b,d,f,g,h,i;for(Offline.trigger("requests:flush"),f={},h=0,i=c.length;i>h;h++)d=c[h],g=d.url.replace(/(\?|&)_=[0-9]+/,function(a,b){return"?"===b?b:""}),f[""+d.type.toUpperCase()+" - "+g]=d;for(b in f)d=f[b],e(d);return a()},setTimeout(function(){return Offline.getOption("requests")!==!1?(Offline.on("confirmed-up",function(){return f?(f=!1,a()):void 0}),Offline.on("up",b),Offline.on("down",function(){return f=!1}),Offline.onXHR(function(a){var b,c,e,f,g;return e=a.xhr,b=a.async,e.offline!==!1&&(c=function(){return d(a)},g=e.send,e.send=function(b){return a.body=b,g.apply(e,arguments)},b)?null===e.onprogress?(e.addEventListener("error",c,!1),e.addEventListener("timeout",c,!1)):(f=e.onreadystatechange,e.onreadystatechange=function(){return 0===e.readyState?c():4===e.readyState&&(0===e.status||e.status>=12e3)&&c(),"function"==typeof f?f.apply(null,arguments):void 0}):void 0}),Offline.requests={flush:b,clear:a}):void 0},0)}.call(this),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m;if(!window.Offline)throw new Error("Offline UI brought in without offline.js");b='<div class="offline-ui"><div class="offline-ui-content"></div></div>',a='<a href class="offline-ui-retry"></a>',e=function(a){var b;return b=document.createElement("div"),b.innerHTML=a,b.children[0]},f=d=null,c=function(a){return k(a),f.className+=" "+a},k=function(a){return f.className=f.className.replace(new RegExp("(^| )"+a.split(" ").join("|")+"( |$)","gi")," ")},h={},g=function(a,b){return c(a),null!=h[a]&&clearTimeout(h[a]),h[a]=setTimeout(function(){return k(a),delete h[a]},1e3*b)},i=function(a,b){var c,d,e,f,g,h;if(null==b&&(b=!1),0===a)return"now";c={d:86400,h:3600,m:60,s:1},d={s:"second",m:"minute",h:"hour",d:"day"},f="";for(g in c)if(e=c[g],a>=e)return h=Math.floor(a/e),b&&(g=" "+d[g],1!==h&&(g+="s")),""+h+g},l=function(){var g,h;return f=e(b),document.body.appendChild(f),null!=Offline.reconnect&&Offline.getOption("reconnect")&&(f.appendChild(e(a)),g=f.querySelector(".offline-ui-retry"),h=function(a){return a.preventDefault(),Offline.reconnect.tryNow()},null!=g.addEventListener?g.addEventListener("click",h,!1):g.attachEvent("click",h)),c("offline-ui-"+Offline.state),d=f.querySelector(".offline-ui-content")},j=function(){return l(),Offline.on("up",function(){return k("offline-ui-down"),c("offline-ui-up"),g("offline-ui-up-2s",2),g("offline-ui-up-5s",5)}),Offline.on("down",function(){return k("offline-ui-up"),c("offline-ui-down"),g("offline-ui-down-2s",2),g("offline-ui-down-5s",5)}),Offline.on("reconnect:connecting",function(){return c("offline-ui-connecting"),k("offline-ui-waiting")}),Offline.on("reconnect:tick",function(){return c("offline-ui-waiting"),k("offline-ui-connecting"),d.setAttribute("data-retry-in-seconds",Offline.reconnect.remaining),d.setAttribute("data-retry-in-abbr",i(Offline.reconnect.remaining)),d.setAttribute("data-retry-in",i(Offline.reconnect.remaining,!0))}),Offline.on("reconnect:stopped",function(){return k("offline-ui-connecting offline-ui-waiting"),d.setAttribute("data-retry-in-seconds",null),d.setAttribute("data-retry-in-abbr",null),d.setAttribute("data-retry-in",null)}),Offline.on("reconnect:failure",function(){return g("offline-ui-reconnect-failed-2s",2),g("offline-ui-reconnect-failed-5s",5)}),Offline.on("reconnect:success",function(){return g("offline-ui-reconnect-succeeded-2s",2),g("offline-ui-reconnect-succeeded-5s",5)})},"complete"===document.readyState?j():null!=document.addEventListener?document.addEventListener("DOMContentLoaded",j,!1):(m=document.onreadystatechange,document.onreadystatechange=function(){return"complete"===document.readyState&&j(),"function"==typeof m?m.apply(null,arguments):void 0})}.call(this),Persist=function(){var a,b,c,d,e,f,g="0.1.0";f=function(){var a,b="Thu, 01-Jan-1970 00:00:01 GMT",c=864e5,d=["expires","path","domain"],e=escape,f=unescape,g=document,h=function(){var a=new Date;return a.setTime(a.getTime()),a},j=function(a,b){var c,f,g,h=[],i=arguments.length>2?arguments[2]:{};for(h.push(e(a)+"="+e(b)),c=0;c<d.length;c++)f=d[c],(g=i[f])&&h.push(f+"="+g);return i.secure&&h.push("secure"),h.join("; ")},k=function(){var a="__EC_TEST__",b=new Date;return b=b.toGMTString(),this.set(a,b),this.enabled=this.remove(a)==b,this.enabled};return a={set:function(a,b){var d=arguments.length>2?arguments[2]:{},e=h(),f={};d.expires&&(d.expires*=c,f.expires=new Date(e.getTime()+d.expires),f.expires=f.expires.toGMTString());var k=["path","domain","secure"];for(i=0;i<k.length;i++)d[k[i]]&&(f[k[i]]=d[k[i]]);var l=j(a,b,f);return g.cookie=l,b},has:function(a){a=e(a);var b=g.cookie,c=b.indexOf(a+"="),d=(c+a.length+1,b.substring(0,a.length));return!c&&a!=d||0>c?!1:!0},get:function(a){a=e(a);var b,c=g.cookie,d=c.indexOf(a+"="),h=d+a.length+1,i=c.substring(0,a.length);return!d&&a!=i||0>d?null:(b=c.indexOf(";",h),0>b&&(b=c.length),f(c.substring(h,b)))},remove:function(c){var d=a.get(c),e={expires:b};return g.cookie=j(c,"",e),d},keys:function(){var a,b,c=g.cookie,d=c.split("; "),e=[];for(a=0;a<d.length;a++)b=d[a].split("="),e.push(f(b[0]));return e},all:function(){var a,b,c=g.cookie,d=c.split("; "),e=[];for(a=0;a<d.length;a++)b=d[a].split("="),e.push([f(b[0]),f(b[1])]);return e},version:"0.2.1",enabled:!1},a.enabled=k.call(a),a}(),e=function(){},c=function(a){return"PS"+a.replace(/_/g,"__").replace(/ /g,"_s")},C={search_order:["gears","localstorage","whatwg_db","globalstorage","flash","ie","cookie"],name_re:/^[a-z][a-z0-9_ -]+$/i,methods:["init","get","set","remove","load","save"],sql:{version:"1",create:"CREATE TABLE IF NOT EXISTS persist_data (k TEXT UNIQUE NOT NULL PRIMARY KEY, v TEXT NOT NULL)",get:"SELECT v FROM persist_data WHERE k = ?",set:"INSERT INTO persist_data(k, v) VALUES (?, ?)",remove:"DELETE FROM persist_data WHERE k = ?"},flash:{div_id:"_persist_flash_wrap",id:"_persist_flash",path:"persist.swf",size:{w:1,h:1},args:{autostart:!0}}},b={gears:{size:-1,test:function(){return window.google&&window.google.gears?!0:!1},methods:{transaction:function(a){var b=this.db;b.execute("BEGIN").close(),a.call(this,b),b.execute("COMMIT").close()},init:function(){var a;a=this.db=google.gears.factory.create("beta.database"),a.open(c(this.name)),a.execute(C.sql.create).close()},get:function(a,b,c){var d,e=C.sql.get;b&&this.transaction(function(f){d=f.execute(e,[a]),d.isValidRow()?b.call(c||this,!0,d.field(0)):b.call(c||this,!1,null),d.close()})},set:function(a,b,c,d){var e=C.sql.remove,f=C.sql.set;this.transaction(function(g){g.execute(e,[a]).close(),g.execute(f,[a,b]).close(),c&&c.call(d||this,!0,b)})},remove:function(a,b,c){var d=C.sql.get;sql=C.sql.remove,val,this.transaction(function(e){b?(r=e.execute(d,[a]),r.isValidRow()?(val=r.field(0),e.execute(sql,[a]).close(),b.call(c||this,!0,val)):b.call(c||this,!1,null),r.close()):e.execute(sql,[a]).close()})}}},whatwg_db:{size:204800,test:function(){var a="PersistJS Test",c="Persistent database test.";return window.openDatabase?window.openDatabase(a,C.sql.version,c,b.whatwg_db.size)?!0:!1:!1},methods:{transaction:function(a){if(!this.db_created){var b=C.sql.create;this.db.transaction(function(a){a.executeSql(b,[],function(){this.db_created=!0})},e)}this.db.transaction(a)},init:function(){var a,c;a=this.o.about||"Persistent storage for "+this.name,c=this.o.size||b.whatwg_db.size,this.db=openDatabase(this.name,C.sql.version,a,c)},get:function(a,b,c){var d=C.sql.get;b&&(c=c||this,this.transaction(function(e){e.executeSql(d,[a],function(a,d){d.rows.length>0?b.call(c,!0,d.rows.item(0).v):b.call(c,!1,null)})}))},set:function(a,b,c,d){var e=C.sql.remove,f=C.sql.set;return this.transaction(function(g){g.executeSql(e,[a],function(){g.executeSql(f,[a,b],function(){c&&c.call(d||this,!0,b)})})}),b},remove:function(a,b,c){var d=C.sql.get;sql=C.sql.remove,this.transaction(function(e){b?e.executeSql(d,[a],function(d,e){if(e.rows.length>0){var f=e.rows.item(0).v;d.executeSql(sql,[a],function(){b.call(c||this,!0,f)})}else b.call(c||this,!1,null)}):e.executeSql(sql,[a])})}}},globalstorage:{size:5242880,test:function(){return window.globalStorage?!0:!1},methods:{key:function(a){return c(this.name)+c(a)},init:function(){this.store=globalStorage[this.o.domain]},get:function(a,b,c){a=this.key(a),b&&b.call(c||this,!0,this.store.getItem(a))},set:function(a,b,c,d){a=this.key(a),this.store.setItem(a,b),c&&c.call(d||this,!0,b)},remove:function(a,b,c){var d;a=this.key(a),d=this.store[a],this.store.removeItem(a),b&&b.call(c||this,null!==d,d)}}},localstorage:{size:-1,test:function(){return window.localStorage?!0:!1},methods:{key:function(a){return c(this.name)+c(a)},init:function(){this.store=localStorage},get:function(a,b,c){a=this.key(a),b&&b.call(c||this,!0,this.store.getItem(a))},set:function(a,b,c,d){a=this.key(a),this.store.setItem(a,b),c&&c.call(d||this,!0,b)},remove:function(a,b,c){var d;a=this.key(a),d=this.getItem(a),this.store.removeItem(a),b&&b.call(c||this,null!==d,d)}}},ie:{prefix:"_persist_data-",size:65536,test:function(){return window.ActiveXObject?!0:!1},make_userdata:function(a){var b=document.createElement("div");return b.id=a,b.style.display="none",b.addBehavior("#default#userData"),document.body.appendChild(b),b},methods:{init:function(){var a=b.ie.prefix+c(this.name);this.el=b.ie.make_userdata(a),this.o.defer&&this.load()},get:function(a,b,d){var e;a=c(a),this.o.defer||this.load(),e=this.el.getAttribute(a),b&&b.call(d||this,e?!0:!1,e)},set:function(a,b,d,e){a=c(a),this.el.setAttribute(a,b),this.o.defer||this.save(),d&&d.call(e||this,!0,b)},load:function(){this.el.load(c(this.name))},save:function(){this.el.save(c(this.name))}}},cookie:{delim:":",size:4e3,test:function(){return a.Cookie.enabled?!0:!1},methods:{key:function(a){return this.name+b.cookie.delim+a},get:function(a,b,c,d){a=this.key(a),b=f.get(a),c&&c.call(d||this,null!=b,b)},set:function(a,b,c,d){a=this.key(a),f.set(a,b,this.o),c&&c.call(d||this,!0,b)},remove:function(a,b,c,d){var b;a=this.key(a),b=f.remove(a),c&&c.call(d||this,null!=b,b)}}},flash:{test:function(){if(!window.SWFObject||!deconcept||!deconcept.SWFObjectUtil)return!1;var a=deconcept.SWFObjectUtil.getPlayerVersion().major;return a>=8?!0:!1},methods:{init:function(){if(!b.flash.el){var a,c,d,e=C.flash;d=document.createElement("div"),d.id=e.div_id,document.body.appendChild(d),a=new SWFObject(this.o.swf_path||e.path,e.id,e.size.w,e.size.h,"8");for(c in e.args)a.addVariable(c,e.args[c]);a.write(d),b.flash.el=document.getElementById(e.id)}this.el=b.flash.el},get:function(a,b,d){var e;a=c(a),e=this.el.get(this.name,a),b&&b.call(d||this,null!==e,e)},set:function(a,b,d,e){var f;a=c(a),f=this.el.set(this.name,a,b),d&&d.call(e||this,!0,b)},remove:function(a,b,d){var e;a=c(a),e=this.el.remove(this.name,a),b&&b.call(d||this,!0,e)}}}};var d=function(){var c,d,f,g,h=C.methods,i=C.search_order;for(c=0,d=h.length;d>c;c++)a.Store.prototype[h[c]]=e;for(a.type=null,a.size=-1,c=0,d=i.length;!a.type&&d>c;c++)if(f=b[i[c]],f.test()){a.type=i[c],a.size=f.size;for(g in f.methods)a.Store.prototype[g]=f.methods[g]}a._init=!0};return a={VERSION:g,type:null,size:0,add:function(a){b[a.id]=a,C.search_order=[a.id].concat(C.search_order),d()},remove:function(a){var c=C.search_order.indexOf(a);0>c||(C.search_order.splice(c,1),delete b[a],d())},Cookie:f,Store:function(b,c){if(!C.name_re.exec(b))throw new Error("Invalid name");if(!a.type)throw new Error("No suitable storage found");c=c||{},this.name=b,c.domain=c.domain||location.hostname||"localhost.localdomain",this.o=c,c.expires=c.expires||730,c.path=c.path||"/",this.init()}},d(),a}(),function(a){a={},a.notification=a.notification||{},a.settings={},a.settings.consoleLog=!1,a.notification.subscribers=[],a.notification.log=[],a.notification.subscribe=function(b,c,d,e){a.notification.subscribers[b]||(a.notification.subscribers[b]={});var f=a.notification.subscribers[b];f[c]={},f[c].response=d,f[c].responseParams=e||null,a.notification.log.push({type:"subscribe",notification:b,subscriber:c})},a.notification.unsubscribe=function(b,c){a.notification.subscribers[b]&&a.notification.subscribers[b][c]&&(delete a.notification.subscribers[b][c],a.notification.log.push({type:"unsubscribe",notification:b,unsubscriber:c}))},a.notification.publish=function(b,c,d){if(a.notification.subscribers[b]){d=d||"unidentified";var e=a.notification.subscribers[b],f=[];for(var g in e){var h={};h.notificationParams=c||null,h.responseParams=a.notification.subscribers[b][g].responseParams||null,setTimeout(function(a,b){return function(){e[a].response(b)}}(g,h),0),f.push(g)}a.notification.log.push({type:"publish",notification:b,informedSubscribers:f,publisher:d}),a.settings.consoleLog!==!1&&(console.log("\n Published: "+b+"\n Publisher: "+d+"\n Informed: "+JSON.stringify(f)),console.log("----------------------\n"))}},window.dxmPubSub=a.notification,window.dxmPubSub.consoleLogOn=function(){a.settings.consoleLog=!0},window.dxmPubSub.consoleLogOff=function(){a.settings.consoleLog=!1}}(),function(){function a(){var a=x();q(),j(),i(),h(),z(),y(),A(),D(),"up"===a?V("network-up",null,this):V("network-down",null,this),g(),m(_)}function b(a){function b(){window.removeEventListener("keydown",c),d.removeEventListener("click",n)}function c(a){13===a.keyCode&&n()}var d=a.getElementsByClassName("btn")[0];X("teardown-screen","landing",b),window.addEventListener("keydown",c),d.addEventListener("click",n)}function c(){function a(){b.removeEventListener("click",L),c.removeEventListener("click",M)}var b=document.getElementById("start-add-product"),c=document.getElementById("start-view-products");X("teardown-screen","tasks",a),c.addEventListener("click",M),b.addEventListener("click",L)}function d(a){function b(){for(var a=0,b=e.length,c=b-1;c>=0;c--)e[c].value||(a+=1,I(e[c],"attention"),e[c].addEventListener("keydown",d));1>a&&(O=f.value,P=g.value,n())}function c(){for(var a=e.length,c=a-1;c>=0;c--)e[c].value="",H(e[c],"attention")&&J(e[c],"attention");h.removeEventListener("click",b)}function d(a){a.target.value&&(J(a.target,"attention"),a.target.removeEventListener("keydown",d))}var e=a.getElementsByTagName("input"),f=a.getElementsByClassName("product-name")[0],g=a.getElementsByClassName("manufacturer-name")[0],h=a.getElementsByClassName("btn")[0];h.addEventListener("click",b),X("teardown-screen","add-product-metadata",c),X("task-ended","reset-new-product-values",function(){O=null,P=null,Q=null})}function e(a){function b(){var a,b={};b.name=encodeURIComponent(O),b.manufacturer=encodeURIComponent(P),K("add-product.php","product="+JSON.stringify(b)),a=confirm("Done! Add Another Product?"),a===!0&&(Y("task-ended","task-teardown"),X("task-ended","restart-task",function(){p("add-product"),L()})),V("task-ended",null,"add-product-btn")}for(var c=a.getElementsByClassName("manufacturer-name"),d=a.getElementsByClassName("product-name"),e=document.getElementById("submit-add-product"),f=c.length-1;f>=0;f--)c[f].innerHTML=P;for(f=d.length-1;f>=0;f--)d[f].innerHTML=O;e.addEventListener("click",b),X("teardown-screen","add-product-confirmation",function(){e.removeEventListener("click",b);for(var a=c.length-1;a>=0;a--)c[a].innerHTML="";for(a=d.length-1;a>=0;a--)d[a].innerHTML=""})}function f(a){function b(){h.removeEventListener("click",e),Y("screens-resized","resize-list-wrapper"),Y("product-metadata-updated","update-product-list"),X("setup-complete","cleanup-product-list",function(){setTimeout(function(){d("{}")},150)})}function c(){h.style.height=.7*a.offsetHeight+"px"}function d(a){var b=JSON.parse(a),c=b.length,d="";!c||1>c?(d="there are no products in the database ...",h.innerHTML=d):R.get("transaction",function(a,e){var f,g="{}";e&&(g=e),f=JSON.parse(g),f.product||(f.product={});for(var i=c;i>=1;i--){var j,k,l,m=b[c-i],n=m.Id;j=f.product&&f.product[n]?!0:!1,k=j&&f.product[n].price?!0:!1,l=k?"&#8358;"+f.product[n].price:m.Price?"&#8358;"+m.Price:"-----",d+="<div class='product"+(j?" editted-product":"")+"' data-product-name='"+m.Name+"' data-product-id='"+n+"'> <div class='name'>"+m.Name+"</div> <div class='price"+(k?" modified-value":"")+"'>"+l+"</div><div class='settings'>edit</div></div>"}h.innerHTML=d})}function e(a){for(var b,c,d,e=a.target;!H(e,"settings");){if(e.parentNode==h)return;e=e.parentNode}if(b=e.parentNode,I(b,"edit-product"),c=b.getAttribute("data-product-id"),d=prompt("Set Price for '"+b.getAttribute("data-product-name").toUpperCase()+"'?"),null!==d){var g=b.getElementsByClassName("price")[0];f(c,d),g.innerHTML="&#8358;"+d,I(g,"modified-value"),I(b,"editted-product")}J(b,"edit-product")}function f(a,b){R.get("transaction",function(c,d){var e,f="{}";d&&(f=d),e=JSON.parse(f),e.product||(e.product={}),e.product[a]||(e.product[a]={}),e.product[a].price=encodeURIComponent(b),R.set("transaction",JSON.stringify(e))})}var g,h=document.getElementById("product-list");X("teardown-screen","teardown",b),W("screens-resized","resize-list-wrapper",c),W("product-metadata-updated","update-product-list",function(a){var b=a.notificationParams;alert("Loading Updates"),d(b)}),c(),R.get("product",function(a,b){b&&(g=b,d(b)),t()}),h.addEventListener("click",e)}function g(){W("setup-screen","do_screen_setup",l)}function h(){G(function(){V("window-resized",null,this)})}function i(){W("window-resized","screen-height-updater",j),W("screens-resized","autoscroller",k)}function j(){for(var a,b,c=ab.length-1;c>=0&&!(_>c);c--)a=document.defaultView.getComputedStyle(ab[c],null).getPropertyValue("padding-top").replace("px",""),b=document.defaultView.getComputedStyle(ab[c],null).getPropertyValue("padding-bottom").replace("px",""),ab[c].style.height=window.innerHeight-a-b+"px";V("screens-resized",null,this)}function k(){bb(ab[_].offsetTop,150)}function l(){var a=ab[_],b=a.id.replace(/\-/g,"_");X("setup-complete","scroll-screen-into-view",function(){bb(a.offsetTop,400)}),I(a,"focal"),X("teardown-screen","defocalizer",function(){J(a,"focal")}),$[b](a),V("setup-complete",null,"do_screen_setup")}function m(a){V("teardown-screen",null,this),_=a,V("setup-screen",null,this)}function n(){m(_+1)}function o(a){for(var b=0,c=0;c<Z.length;c++)H(Z[c],a)&&(I(Z[c],"active"),ab.push(Z[c]),b+=1);b>0&&j()}function p(a){for(var b=0,c=ab.length-1;c>=0;c--)H(ab[c],a)&&(J(ab[c],"active"),ab.splice(c,1),b+=1),b>0&&(j(),_=ab.length-1)}function q(){for(var a=0;a<Z.length;a++)J(Z[a],"active");ab=[],o("landing"),o("tasks")}function r(){var a=function(){clearInterval(S.heartbeat),delete S.heartbeat};S.heartbeat=setInterval(T.check,7500),X("network-down","heartbeat",a,null)}function s(){var a=function(){clearInterval(S.transaction),delete S.transaction};S.transaction=setInterval(function(){R.get("transaction",function(a,b){var c=JSON.parse(b),d=!1;if(c){for(var e in c)if(c.hasOwnProperty(e)){d=!0;break}d&&(K("process-transaction.php","transaction="+b,function(a){var b=JSON.parse(a);t(),console.log("-- TRANSACTION REPORT --"),b.product&&R.get("product",function(a,c){var d=JSON.parse(c);for(var e in b.product){for(var f,g=d.length-1;g>=0;g--)if(d[d.length-1-g].Id==e){f=d[d.length-1-g].Name;break}for(var h in b.product[e])console.log(f.toUpperCase()+" "+h.toUpperCase()+" UPDATED TO '"+b.product[e][h]+"'")}})}),R.set("transaction","{}"))}})},3e4),X("network-down","transaction",a,null)}function t(){R.get("product",function(a,b){K("get-product.php",null,function(a){b!=a&&(R.set("product",a),V("product-metadata-updated",a,"update-product-db-ajax"))})})}function u(){var a=document.getElementsByClassName("connection-indicator");S.checkingLightFlickerInterval=setInterval(function(){for(var b=a.length-1;b>=0;b--)I(a[b],"connection-checking"),setTimeout(function(){var c=b;return function(){J(a[c],"connection-checking")}}(),350)},2e3),X("network-reconnecting-exit","light-flicker",function(){clearInterval(S.checkingLightFlickerInterval)},null)}function v(){J(document.body,"connection-offline"),I(document.body,"connection-online")}function w(){J(document.body,"connection-online"),I(document.body,"connection-offline")}function x(){return T.check(),T.state}function y(){T.on("up",function(){V("network-up",null,"connection-watchdog")}),T.on("down",function(){V("network-down",null,"connection-watchdog")}),T.on("reconnect:started",function(){V("network-reconnecting",null,"connection-watchdog")}),T.on("reconnect:stopped",function(){V("network-reconnecting-exit",null,"connection-watchdog")})}function z(){W("network-up","online-indicator",v),W("network-up","heartbeat",r),W("network-up","transaction",s),W("network-down","online-indicator",w),W("network-reconnecting","light-flicker",u)}function A(){window.applicationCache&&(window.applicationCache.addEventListener("downloading",C),window.applicationCache.addEventListener("updateready",B))}function B(){alert("App Has Been Updated and will Restart Now"),window.applicationCache.swapCache(),location.reload(!0)}function C(){alert("Downloading App Updates - Sorry for the Wait")}function D(){E()}function E(){R=new Persist.Store("Pricing App Storage",{about:"Data Storage to enhance Offline usage",path:location.href})}function F(a,b,c,d){W(a,b,function(){c(d),Y(a,b)},d)}function G(a,b){return onresize=function(){clearTimeout(b),b=setTimeout(a,250)},a}function H(a,b){return a.className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))}function I(a,b){H(a,b)||(a.className+=" "+b)}function J(a,b){if(H(a,b)){var c=new RegExp("(\\s|^)"+b+"(\\s|$)");a.className=a.className.replace(c," ")}}function K(a,b,c,d){if(!a)return!1;var e=new XMLHttpRequest;return b=b||"",c=c||function(b){console.log("POST TO "+a+" SUCCESSFUL! \nRESPONSE: "),console.log(b)},d=d||function(b){console.log("POST TO "+a+" UNSUCCESSFUL. \nXMLHTTP OBJECT:"),console.log(b)},e.open("POST",a,!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.onreadystatechange=function(){4==e.readyState&&(e.status>199&&e.status<400?c(e.responseText):d(e))},e.send(b),!0}function L(){o("add-product"),n(),N(),X("task-ended","task-teardown",function(){m(1),setTimeout(function(){p("add-product")},250)})}function M(){o("view-product"),n(),N(),X("task-ended","task-teardown",function(){m(1),setTimeout(function(){p("view-product")},250)})}function N(){var a=document.getElementById("context-settings"),b="<div id='cancel-task' class='setting'>cancel task</div>";a.innerHTML+=b,X("task-ended","remove-cancel-task-btn",function(){var a=document.getElementById("cancel-task");a.parentNode.removeChild(a)}),document.getElementById("cancel-task").addEventListener("click",function(){V("task-ended","cancel-task-btn")})}var O,P,Q,R,S={},T=Offline,U=dxmPubSub,V=U.publish,W=U.subscribe,X=F,Y=U.unsubscribe,Z=document.getElementsByClassName("fullscreen"),$={},_=0,ab=[];$.landing=b,$.tasks=c,$.add_product_metadata=d,$.add_product_confirmation=e,$.view_product_list=f,T.options={checkOnLoad:!0,interceptRequests:!1,requests:!1,checks:{active:"xhr",xhr:{url:"server-check.php"}}};var bb=function(){var a,b,c;return function(d,e,f){function g(){var d;c=(Date.now()-b)/e,c>=1&&(clearInterval(a),c=1,f()),d=c*i+h,window.scrollBy(0,d-window.pageYOffset)}var h=window.pageYOffset,i=d-window.pageYOffset;return e=e||400,f=f||function(){V("arrived-at-new-screen",null,"scroll-screen-into-view")},b=Date.now(),c=0,a&&clearInterval(a),a=setInterval(g,10)}}();U.log.crawl=function(a){for(var b="",c=0;c<U.log.length-1;c+=1)(("string"==typeof a||a instanceof String)&&(("string"==typeof U.log[c].publisher||U.log[c].publisher instanceof String)&&U.log[c].publisher.toLowerCase()==a.toLowerCase()||("string"==typeof U.log[c].subscriber||U.log[c].subscriber instanceof String)&&U.log[c].subscriber.toLowerCase()==a.toLowerCase()||("string"==typeof U.log[c].unsubscriber||U.log[c].unsubscriber instanceof String)&&U.log[c].unsubscriber.toLowerCase()==a.toLowerCase()||("string"==typeof U.log[c].type||U.log[c].type instanceof String)&&U.log[c].type.toLowerCase()==a.toLowerCase()||("string"==typeof U.log[c].notification||U.log[c].notification instanceof String)&&U.log[c].notification.toLowerCase()==a.toLowerCase())||null===a&&U.log[c].publisher)&&(b+="\n\n-["+c+"]-\n["+(U.log[c].subscriber||U.log[c].publisher||U.log[c].unsubscriber)+"] "+U.log[c].type+" "+U.log[c].notification);console.log(b)},U.log.range=function(a,b){var c,d,e="";if(c=a>b?b:a,d=a>b?a:b,0>c||d>U.log.length-1)return console.log("wtf bro");console.log("crawling "+c+" to "+d);for(var f=c;d>=f;f+=1)e+="\n\n-["+f+"]-\n["+(U.log[f].subscriber||U.log[f].publisher||U.log[f].unsubscriber)+"] "+U.log[f].type+" "+U.log[f].notification;console.log(e)},document.addEventListener("DOMContentLoaded",function(){a(),goto=m,ASE=ab,currentIntervals=S})}();